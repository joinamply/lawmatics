<script>
    window.Webflow ||= [];
    window.Webflow.push(() => {
        // Check if any element with class 'tl-card' exists on the page
        if ($('.tl-card').length > 0) {
            $('.section').each(function () {
                const $section = $(this);
                const $cards = $section.find('.tl-card');
                // Create a GSAP timeline for the cards in this section, initially paused
                let tlMain = gsap.timeline({ paused: true, defaults: { duration: 0.5 } });

                $cards.each(function (index, card) {
                    const $dot = $(card).find('[tl-card="dot"]');
                    const $step = $(card).find('[tl-card="step"]');
                    const $cardContent = $(card).find('[tl-card="card"]');
                    let tl = new gsap.timeline({ defaults: { duration: 0.5, ease: "power2.out" } });

                    // Animate each card sequentially in the timeline
                    tl.to($dot, { opacity: 1 })
                        .fromTo($step, { x: '4rem', opacity: 0 }, { x: 0, opacity: 1 })
                        .fromTo($cardContent, { x: '4rem', opacity: 0 }, { x: 0, opacity: 1 }, "<");
                    tlMain.add(tl, index === 0 ? 0 : '<.8');
                });

                // Use GSAP ScrollTrigger to play the timeline when .section top reaches 80% of viewport
                ScrollTrigger.create({
                    trigger: $section[0],
                    start: "top 90%",
                    onEnter: () => tlMain.play()
                });
            });
        }
    });
</script>